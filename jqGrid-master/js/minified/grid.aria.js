/**
*
* @license Guriddo jqGrid JS - v5.3.2 
* Copyright(c) 2008, Tony Tomov, tony@trirand.com
* 
* License: http://guriddo.net/?page_id=103334
*/
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base"],a):a(jQuery)}(function(a){"use strict";a.extend(a.jgrid,{focusableElementsList:[">a[href]",">button:not([disabled])",">area[href]",">input:not([disabled])",">select:not([disabled])",">textarea:not([disabled])",">iframe",">object",">embed",">*[tabindex]",">*[contenteditable]"]}),a.jgrid.extend({ariaBodyGrid:function(){return this.each(function(){function b(a,b){return!isNaN(a)&&!isNaN(b)&&a>=0&&b>=0&&g.rows.length&&a<g.rows.length&&b<g.p.colModel.length}function c(a,c){var d=g.p.iRow+c,e=g.p.iCol+a,f=g.rows.length,h=0!==a;if(!f)return!1;var i=g.p.colModel.length;return h&&(e<0&&(e=i-1,d--),e>=i&&(e=0,d++)),h||(d<1?(e--,d=f-1,g.rows[d]&&e>=0&&!g.rows[d].cells[e]&&d--):(d>=f||!g.rows[d].cells[e])&&(d=1,e++)),b(d,e)?{row:d,col:e}:!!b(g.p.iRow,g.p.iCol)&&{row:g.p.iRow,col:g.p.iCol}}function d(b,d){var e=c(b,d);if(!e)return!1;for(;a(g.rows[e.row].cells[e.col]).is(":hidden");)if(g.p.iRow=e.row,g.p.iCol=e.col,e=c(b,d),g.p.iRow===e.row&&g.p.iCol===e.col)return!1;return 0!==d&&a(g).jqGrid("setSelection",g.rows[e.row].id,!1,null,!1),e}function e(a){var b=g.p.page,c=g.p.lastpage;b+=a,b<=0&&(b=1),b>c&&(b=c),g.p.page!==b&&(g.p.page=b,g.grid.populate())}function f(b){return a(j,b)[0]}var g=this,h=a.jgrid.getMethod("getStyleUI"),i=h(g.p.styleUI+".common","highlight",!0),j=a.jgrid.focusableElementsList.join();a(g).removeAttr("tabindex"),a(g).on("jqGridAfterGridComplete.setAriaGrid",function(b){a("tbody:first>tr:not(.jqgfirstrow)>td:not(:hidden, :has("+j+"))",g).attr("tabindex",-1),a("tbody:first>tr:not(.jqgfirstrow)",g).removeAttr("tabindex"),void 0!==g.p.iRow&&void 0!==g.p.iCol&&a(g.rows[g.p.iRow].cells[g.p.iCol]).attr("tabindex",0).focus(function(){a(this).addClass(i)}).blur(function(){a(this).removeClass(i)})}),g.p.iRow=1,g.p.iCol=a.jgrid.getFirstVisibleCol(g);var k=0,l=0;a(g).on("keydown",function(b){var c,h=b.which||b.keyCode;switch(h){case 38:c=d(0,-1),k=c.row,l=c.col,b.preventDefault();break;case 40:c=d(0,1),k=c.row,l=c.col,b.preventDefault();break;case 37:c=d(-1,0),k=c.row,l=c.col,b.preventDefault();break;case 39:c=d(1,0),k=c.row,l=c.col,b.preventDefault();break;case 36:k=b.ctrlKey?1:g.p.iRow,l=0,b.preventDefault();break;case 35:k=b.ctrlKey?g.rows.length-1:g.p.iRow,l=g.p.colModel.length-1,b.preventDefault();break;case 33:e(-1),l=g.p.iCol,k=g.p.iRow,b.preventDefault();break;case 34:e(1),l=g.p.iCol,k=g.p.iRow,k>g.rows.length-1&&(k=g.rows.length-1,g.p.iRow=g.rows.length-1),b.preventDefault();break;default:return}var j;!isNaN(g.p.iRow)&&!isNaN(g.p.iCol)&&g.p.iCol>=0&&(j=f(g.rows[g.p.iRow].cells[g.p.iCol]),j?a(j).attr("tabindex",-1):a(g.rows[g.p.iRow].cells[g.p.iCol]).attr("tabindex",-1)),j=f(g.rows[k].cells[l]),j?a(j).attr("tabindex",0).addClass(i).focus().blur(function(){a(this).removeClass(i)}):a(g.rows[k].cells[l]).attr("tabindex",0).addClass(i).focus().blur(function(){a(this).removeClass(i)}),g.p.iRow=k,g.p.iCol=l}),a(g).on("jqGridBeforeSelectRow.ariaGridClick",function(){return!1}),a(g).on("jqGridCellSelect.ariaGridClick",function(b,c,d,e,f){var h=f.target;if(g.p.iRow>0&&g.p.iCol>=0&&a(g.rows[g.p.iRow].cells[g.p.iCol]).attr("tabindex",-1),a(h).is("td")||a(h).is("th")){g.p.iCol=h.cellIndex;var j=a(h).closest("tr.jqgrow");g.p.iRow=j[0].rowIndex,a(h).attr("tabindex",0).addClass(i).focus().blur(function(){a(this).removeClass(i)})}})})},ariaHeaderGrid:function(){return this.each(function(){var b=this,c=a.jgrid.getMethod("getStyleUI"),d=c(b.p.styleUI+".common","highlight",!0),e=a(".ui-jqgrid-hbox>table:first","#gbox_"+b.p.id);a("tr.ui-jqgrid-labels",e).on("keydown",function(c){var d=b.p.selHeadInd,e=c.which||c.keyCode,f=b.grid.headers.length;switch(e){case 37:if(d-1>=0){for(d--;a(b.grid.headers[d].el).is(":hidden")&&d-1>=0&&!(--d<0););d>=0&&(a(b.grid.headers[d].el).focus(),b.p.selHeadInd=d,c.preventDefault())}break;case 39:if(d+1<f){for(d++;a(b.grid.headers[d].el).is(":hidden")&&d+1<f&&!(++d>f-1););d<f&&(a(b.grid.headers[d].el).focus(),b.p.selHeadInd=d,c.preventDefault())}break;case 13:a("div:first",b.grid.headers[d].el).trigger("click"),c.preventDefault();break;default:return}}),a("tr.ui-jqgrid-labels>th:not(:hidden)",e).attr("tabindex",-1).focus(function(){a(this).addClass(d).attr("tabindex","0")}).blur(function(){a(this).removeClass(d)}),b.p.selHeadInd=a.jgrid.getFirstVisibleCol(b),a(b.grid.headers[b.p.selHeadInd].el).attr("tabindex","0")})},ariaPagerGrid:function(){return this.each(function(){var b=this,c=a.jgrid.getMethod("getStyleUI"),d=c(b.p.styleUI+".common","highlight",!0),e="."+c(b.p.styleUI+".common","disabled",!0),f=a(".ui-pg-button",b.p.pager),g=f.length;f.attr("tabindex","-1").focus(function(){a(this).addClass(d)}).blur(function(){a(this).removeClass(d)}),b.p.navIndex=0,f.not(e).first().attr("tabindex","0"),a("table.ui-pager-table tr:first",b.p.pager).on("keydown",function(c){var d=c.which||c.keyCode,h=b.p.navIndex;switch(d){case 37:if(h-1>=0){for(h--;a(f[h]).is(e)&&h-1>=0&&!(--h<0););h>=0&&(a(f[b.p.navIndex]).attr("tabindex","-1"),a(f[h]).attr("tabindex","0").focus(),b.p.navIndex=h),c.preventDefault()}break;case 39:if(h+1<g){for(h++;a(f[h]).is(e)&&h+1<g+1&&!(++h>g-1););h<g&&(a(f[b.p.navIndex]).attr("tabindex","-1"),a(f[h]).attr("tabindex","0").focus(),b.p.navIndex=h),c.preventDefault()}break;case 13:a(f[h]).trigger("click"),c.preventDefault();break;default:return}})})},setAriaGrid:function(b){var c=a.extend({header:!0,body:!0,pager:!0},b||{});return this.each(function(){c.header&&a(this).jqGrid("ariaHeaderGrid"),c.body&&a(this).jqGrid("ariaBodyGrid"),c.pager&&a(this).jqGrid("ariaPagerGrid")})},resetAriaGrid:function(b){var c=a.extend({header:!0,body:!0,pager:!0},b||{});return this.each(function(){var b=this;if(c.body){a(b).attr("tabindex","0").off("keydown").off("jqGridBeforeSelectRow.ariaGridClick").off("jqGridCellSelect.ariaGridClick").off("jqGridAfterGridComplete.setAriaGrid");var d=a.jgrid.focusableElementsList.join();a("tbody:first>tr:not(.jqgfirstrow)>td:not(:hidden, :has("+d+"))",b).removeAttr("tabindex").off("focus"),a("tbody:first>tr:not(.jqgfirstrow)",b).attr("tabindex",-1)}if(c.header){var e=a(".ui-jqgrid-hbox>table:first","#gbox_"+b.p.id);a("tr.ui-jqgrid-labels",e).off("keydown"),a("tr.ui-jqgrid-labels>th:not(:hidden)",e).removeAttr("tabindex").off("focus blur")}c.pager&&(a(".ui-pg-button",b.p.pager).removeAttr("tabindex").off("focus"),a("table.ui-pager-table tr:first",b.p.pager).off("keydown"))})}})});